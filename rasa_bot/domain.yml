version: "3.1"

intents:
  - greet
  - goodbye
  - affirm
  - deny
  - bot_challenge
  - nlu_fallback
  
  # ƒê·∫∑t b√†n
  - book_table
  - ask_available_tables
  - cancel_reservation
  - confirm_booking
  - modify_booking
  
  # Xem th·ª±c ƒë∆°n
  - view_menu
  - ask_menu_categories
  - ask_featured_dishes
  - ask_dish_price
  - ask_dish_details
  
  # ƒê·∫∑t m√≥n
  - order_food
  - add_to_order
  - view_current_order
  - modify_order
  - confirm_order
  - cancel_order
  
  # H·ªèi th√¥ng tin
  - ask_opening_hours
  - ask_address
  - ask_contact
  - ask_promotions
  
  # G·ª£i √Ω m√≥n ƒÉn
  - recommend_dishes
  - ask_popular_dishes
  - ask_special_dishes

  # Qu·∫£n l√Ω h·ªôi tho·∫°i n√¢ng cao  
  - contextual_question
  - modify_specific_field
  - order_item_reference
  
  # Thanh to√°n
  - request_payment
  - process_payment
  - check_payment_status
  - select_payment_method

entities:
  - number_of_people
  - date
  - time
  - dish_name
  - quantity
  - table_type
  - location
  - confirmation
  - modification_type
  - phone_number
  - customer_name
  - payment_method

slots:
  number_of_people:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: number_of_people
    
  reservation_date:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: date
    
  reservation_time:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: time
    
  table_type:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: table_type
    
  current_order:
    type: list
    initial_value: []
    influence_conversation: true
    mappings:
    - type: custom
    
  current_order_id:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: custom
    
  active_table_id:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: custom
    
  dish_name:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: dish_name
    
  last_mentioned_dish:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: dish_name
    
  # Context management slots
  conversation_context:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: custom
    
  current_step:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: custom
    
  pending_confirmation:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
    - type: custom
    
  # Booking management slots
  last_booking_id:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
    
  # Customer information slots
  customer_name:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: customer_name
    
  customer_phone:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: phone_number
    
  # Order management slots
  current_dish_quantity:
    type: float
    initial_value: null
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: quantity

  # Enhanced order confirmation slots
  pending_order_item:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: custom
    
  suggested_dishes:
    type: list
    initial_value: []
    influence_conversation: true
    mappings:
    - type: custom

  # Advanced conversation management slots
  last_mentioned_dishes:
    type: list
    initial_value: []
    influence_conversation: true
    mappings:
    - type: custom
    
  last_action_type:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: custom
    
  item_to_modify:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: custom
    
  # Payment slots
  payment_order_id:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
    
  payment_amount:
    type: float
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
    
  payment_method:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: payment_method
    
  last_order_id:
    type: text
    initial_value: null
    influence_conversation: false
    mappings:
    - type: custom
    
  modification_type:
    type: text
    initial_value: null
    influence_conversation: true
    mappings:
    - type: custom

forms:
  booking_form:
    required_slots:
      - number_of_people
      - reservation_date
      - reservation_time
      
  order_form:
    required_slots:
      - dish_name
      - current_dish_quantity

responses:
  utter_greet:
  - text: "Xin ch√†o! T√¥i l√† tr·ª£ l√Ω ·∫£o c·ªßa nh√† h√†ng. T√¥i c√≥ th·ªÉ gi√∫p b·∫°n ƒë·∫∑t b√†n, xem th·ª±c ƒë∆°n, g·ªçi m√≥n ho·∫∑c tr·∫£ l·ªùi c√°c c√¢u h·ªèi v·ªÅ nh√† h√†ng. B·∫°n c·∫ßn t√¥i h·ªó tr·ª£ g√¨?"

  utter_goodbye:
  - text: "T·∫°m bi·ªát! C·∫£m ∆°n b·∫°n ƒë√£ s·ª≠ d·ª•ng d·ªãch v·ª• c·ªßa ch√∫ng t√¥i. Ch√∫c b·∫°n c√≥ m·ªôt ng√†y tuy·ªát v·ªùi!"

  utter_iamabot:
  - text: "T√¥i l√† tr·ª£ l√Ω ·∫£o c·ªßa nh√† h√†ng, ƒë∆∞·ª£c t·∫°o ra ƒë·ªÉ h·ªó tr·ª£ b·∫°n v·ªõi c√°c d·ªãch v·ª• ƒë·∫∑t b√†n, g·ªçi m√≥n v√† th√¥ng tin nh√† h√†ng."

  utter_ask_number_of_people:
  - text: "B·∫°n mu·ªën ƒë·∫∑t b√†n cho bao nhi√™u ng∆∞·ªùi?"

  utter_ask_reservation_date:
  - text: "B·∫°n mu·ªën ƒë·∫∑t b√†n v√†o ng√†y n√†o? (V√≠ d·ª•: h√¥m nay, ng√†y mai, 20/10/2025)"

  utter_ask_reservation_time:
  - text: "B·∫°n mu·ªën ƒë·∫∑t b√†n v√†o l√∫c m·∫•y gi·ªù? (V√≠ d·ª•: 19:00, 7 gi·ªù t·ªëi)"

  utter_ask_customer_name:
  - text: "Xin cho bi·∫øt t√™n c·ªßa b·∫°n ƒë·ªÉ ƒë·∫∑t b√†n?"

  utter_ask_customer_phone:
  - text: "Xin cho bi·∫øt s·ªë ƒëi·ªán tho·∫°i li√™n h·ªá?"

  utter_ask_dish_name:
  - text: "B·∫°n mu·ªën g·ªçi m√≥n g√¨?"

  utter_ask_current_dish_quantity:
  - text: "B·∫°n mu·ªën g·ªçi bao nhi√™u ph·∫ßn {last_mentioned_dish}?"

  utter_confirm_reservation:
  - text: "T√¥i s·∫Ω ƒë·∫∑t b√†n cho {number_of_people} ng∆∞·ªùi v√†o l√∫c {reservation_time} ng√†y {reservation_date}. B·∫°n c√≥ x√°c nh·∫≠n kh√¥ng?"

  utter_reservation_success:
  - text: "ƒê√£ ƒë·∫∑t b√†n th√†nh c√¥ng! M√£ ƒë·∫∑t b√†n c·ªßa b·∫°n l√† #{reservation_id}. Ch√∫ng t√¥i s·∫Ω li√™n h·ªá v·ªõi b·∫°n ƒë·ªÉ x√°c nh·∫≠n."

  utter_show_menu:
  - text: "ƒê√¢y l√† th·ª±c ƒë∆°n c·ªßa ch√∫ng t√¥i. B·∫°n c√≥ th·ªÉ xem theo danh m·ª•c ho·∫∑c t√¥i c√≥ th·ªÉ gi·ªõi thi·ªáu nh·ªØng m√≥n ƒë·∫∑c bi·ªát."

  utter_ask_dish_quantity:
  - text: "B·∫°n mu·ªën g·ªçi bao nhi√™u ph·∫ßn {dish_name}?"

  utter_add_to_order_success:
  - text: "ƒê√£ th√™m {quantity} ph·∫ßn {dish_name} v√†o ƒë∆°n h√†ng c·ªßa b·∫°n."

  utter_show_current_order:
  - text: "ƒê∆°n h√†ng hi·ªán t·∫°i c·ªßa b·∫°n:"

  utter_confirm_order:
  - text: "B·∫°n c√≥ mu·ªën x√°c nh·∫≠n ƒë∆°n h√†ng n√†y kh√¥ng?"

  utter_order_success:
  - text: "ƒê∆°n h√†ng c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c x√°c nh·∫≠n! M√£ ƒë∆°n h√†ng: #{order_id}. Th·ªùi gian chu·∫©n b·ªã ∆∞·ªõc t√≠nh: {preparation_time} ph√∫t."

  utter_opening_hours:
  - text: "Nh√† h√†ng m·ªü c·ª≠a t·ª´ 10:00 s√°ng ƒë·∫øn 10:00 t·ªëi, t·ª´ th·ª© 2 ƒë·∫øn ch·ªß nh·∫≠t."

  utter_address:
  - text: "ƒê·ªãa ch·ªâ nh√† h√†ng: 123 ƒê∆∞·ªùng Nguy·ªÖn VƒÉn C·ª´, Qu·∫≠n 1, TP.HCM. ƒêi·ªán tho·∫°i: (028) 3123 4567"

  utter_contact:
  - text: "Th√¥ng tin li√™n h·ªá:\nüìû ƒêi·ªán tho·∫°i: (028) 3123 4567\nüìß Email: info@restobot.com\nüåê Website: www.restobot.com"

  utter_current_promotions:
  - text: "Ch∆∞∆°ng tr√¨nh khuy·∫øn m√£i hi·ªán t·∫°i:\nüéâ Gi·∫£m 20% cho ƒë∆°n h√†ng tr√™n 500k\nüç∞ T·∫∑ng m√≥n tr√°ng mi·ªáng cho b√†n t·ª´ 4 ng∆∞·ªùi\nü•§ N∆∞·ªõc u·ªëng mi·ªÖn ph√≠ v√†o th·ª© 3 h√†ng tu·∫ßn"

  utter_popular_dishes:
  - text: "Nh·ªØng m√≥n ƒÉn ƒë∆∞·ª£c y√™u th√≠ch nh·∫•t t·∫°i nh√† h√†ng:"

  utter_special_dishes:
  - text: "M√≥n ƒë·∫∑c bi·ªát h√¥m nay:"

  utter_default:
  - text: "üòä T√¥i ch∆∞a hi·ªÉu r√µ √Ω b·∫°n. ƒê·ªÉ t√¥i c√≥ th·ªÉ h·ªó tr·ª£ t·ªët h∆°n, b·∫°n c√≥ th·ªÉ n√≥i c·ª• th·ªÉ h∆°n ƒë∆∞·ª£c kh√¥ng?"
  - text: "ü§î C√≥ v·∫ª nh∆∞ t√¥i ch∆∞a n·∫Øm ƒë∆∞·ª£c y√™u c·∫ßu c·ªßa b·∫°n. H√£y th·ª≠ di·ªÖn ƒë·∫°t theo c√°ch kh√°c nh√©!"
  - text: "üí° T√¥i c√≥ th·ªÉ gi√∫p b·∫°n: **ƒë·∫∑t b√†n**, **xem th·ª±c ƒë∆°n**, **g·ªçi m√≥n**, ho·∫∑c **h·ªèi th√¥ng tin nh√† h√†ng**. B·∫°n c·∫ßn t√¥i h·ªó tr·ª£ g√¨?"

  utter_ask_rephrase:
  - text: "üôè Xin l·ªói, b·∫°n c√≥ th·ªÉ n√≥i l·∫°i theo c√°ch kh√°c ƒë∆∞·ª£c kh√¥ng? T√¥i mu·ªën hi·ªÉu r√µ ƒë·ªÉ h·ªó tr·ª£ b·∫°n t·ªët nh·∫•t."
  - text: "üòÖ T√¥i c√≥ th·ªÉ hi·ªÉu nh·∫ßm √Ω b·∫°n. B·∫°n c√≥ th·ªÉ di·ªÖn ƒë·∫°t r√µ h∆°n m·ªôt ch√∫t ƒë∆∞·ª£c kh√¥ng?"

  utter_deny_request:
  - text: "ƒê∆∞·ª£c r·ªìi, t√¥i hi·ªÉu. B·∫°n c√≥ c·∫ßn t√¥i h·ªó tr·ª£ g√¨ kh√°c kh√¥ng?"
  - text: "Kh√¥ng sao c·∫£. B·∫°n c·∫ßn t√¥i gi√∫p vi·ªác g√¨ kh√°c kh√¥ng?"

  utter_error:
  - text: "Xin l·ªói, c√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i sau ho·∫∑c li√™n h·ªá b·ªô ph·∫≠n h·ªó tr·ª£."

actions:
  # Menu actions
  - action_show_menu
  - action_show_popular_dishes
  - action_show_special_dishes
  - action_show_bestseller_dishes
  - action_ask_dish_details
  - action_ask_dish_price
  - action_recommend_dishes

  # Booking actions
  - action_show_available_tables
  - action_book_table
  - action_cancel_reservation
  - action_confirm_cancel_reservation
  - action_confirm_booking
  - action_modify_booking

  # Order actions
  - action_add_to_order
  - action_view_current_order
  - action_show_current_order
  - action_confirm_order
  - action_confirm_order_final
  - action_cancel_order
  - action_confirm_cancel_order
  - action_deny_cancellation
  - action_modify_order
  - action_remove_from_order
  - action_modify_order_item

  # Info actions
  - action_show_opening_hours
  - action_show_address
  - action_show_contact
  - action_show_promotions

  # Conversation management actions
  - action_handle_contextual_query
  - action_reset_context
  - action_conversation_manager
  - action_update_conversation_context
  - action_smart_suggestion

  # Form actions
  - booking_form
  - order_form

  # Utility actions
  - action_deny_request
  - action_handle_error
  
  # Enhanced order confirmation actions
  - action_confirm_order_item
  - action_select_dish_by_number

  # Payment actions
  - action_initiate_payment
  - action_process_payment
  - action_check_payment_status

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true